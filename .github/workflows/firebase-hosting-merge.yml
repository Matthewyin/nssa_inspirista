# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase App Hosting on merge
on:
  push:
    branches:
      - main
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set Firebase configuration
        run: |
          # Use known Firebase configuration for this project
          echo "NEXT_PUBLIC_FIREBASE_API_KEY=AIzaSyAQVuM1XSbFw_x3IQ0ZV98XwCWGbgFhIGM" >> $GITHUB_ENV
          echo "NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=n8n-project-460516.firebaseapp.com" >> $GITHUB_ENV
          echo "NEXT_PUBLIC_FIREBASE_PROJECT_ID=n8n-project-460516" >> $GITHUB_ENV
          echo "NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=n8n-project-460516.appspot.com" >> $GITHUB_ENV
          echo "NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=18068529376" >> $GITHUB_ENV
          echo "NEXT_PUBLIC_FIREBASE_APP_ID=1:18068529376:web:8d39b5696a45e3d7494bf1" >> $GITHUB_ENV
          echo "NEXT_PUBLIC_APP_ENV=production" >> $GITHUB_ENV

      - run: |
          if [ -f "package-lock.json" ]; then
            npm ci
          else
            npm i
          fi
          npm run build
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_NSSA_INSPIRISTA }}'
          channelId: live
          force: true
        env:
          FIREBASE_CLI_EXPERIMENTS: webframeworks
